---
  - hosts: centos
    become: no
    gather_facts: no
    tasks:
    - name: Sprawdzenie wolnego miejsca na dyskach windows
      register: RET1
      shell: 
        '{{playbook_dir}}/getFreeDisk wins' 
      args:
        executable: /bin/bash
    - debug:
        msg: System {{RET1}} oraz {{RET1.stdout}} oraz {{windows.wins.ip}}
    - name: Pobranie wielkości dysków które mają być powiększone 
      register: RET2
      shell: 
        '{{playbook_dir}}/GetSizeDisk wins' 
      args:
        executable: /bin/bash
    - name: Sprawdzenie które dyski należy powiekszyc na wirtualnej maszynie
      register: RET3
      shell:
        ssh root@{{windows.wins.virt_server}} cat {{windows.wins.virt_config}} |grep {{windows.wins.virt_data}} |grep "size={{RET2.stdout}}G" |awk -F':' '{print($1);}'
      args:
        executable: /bin/bash
    - debug:
        msg: System {{RET3}}
    - name: Powiekszenie dyskow na virtualce
      shell:
        echo "{{item}}" | awk -e '{print("qm resize 127 "$1" 3G\n")};' | tee -a {{playbook_dir}}/test4.txt | ssh root@{{windows.wins.virt_server}} bash
      args:
        executable: /bin/bash
      with_items: 
        - "{{ RET3.stdout }}"
   
      